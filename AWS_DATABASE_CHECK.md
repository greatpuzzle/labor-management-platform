# AWS 데이터베이스 확인 가이드

## 현재 상황

- **EC2 인스턴스**: 43.200.44.109 (확인됨)
- **PostgreSQL**: EC2에 설치되어 있지 않음
- **RDS 인스턴스**: 확인 필요

## AWS Console에서 확인하는 방법

### 1. RDS 인스턴스 확인

1. **AWS Console 접속**
   - https://console.aws.amazon.com/ 접속
   - 리전: `ap-northeast-2` (서울) 또는 사용 중인 리전 확인

2. **RDS 서비스로 이동**
   - 서비스 검색에서 "RDS" 입력
   - 또는 서비스 목록에서 "RDS" 클릭

3. **데이터베이스 목록 확인**
   - 좌측 메뉴에서 "데이터베이스" 클릭
   - PostgreSQL 또는 다른 데이터베이스 엔진이 있는지 확인
   - 각 데이터베이스의 "엔드포인트" 확인 (예: `xxxxx.xxxxx.ap-northeast-2.rds.amazonaws.com`)

### 2. RDS 인스턴스가 있는 경우

RDS 인스턴스가 있다면:

1. **엔드포인트 확인**
   - RDS 콘솔에서 데이터베이스를 선택
   - "연결 및 보안" 탭에서 엔드포인트 확인

2. **포트 확인**
   - 기본값: PostgreSQL은 5432

3. **사용자 이름 확인**
   - 마스터 사용자 이름 확인

4. **비밀번호 확인**
   - 마스터 비밀번호 (기억하거나 AWS Secrets Manager에서 확인)

5. **보안 그룹 확인**
   - RDS 보안 그룹에서 EC2 인스턴스(43.200.44.109)의 IP를 허용했는지 확인
   - 또는 EC2의 보안 그룹 ID를 RDS 보안 그룹의 인바운드 규칙에 추가

6. **.env 파일 업데이트**
   ```
   DATABASE_URL="postgresql://username:password@rds-endpoint:5432/labor_management?schema=public"
   ```

### 3. RDS 인스턴스가 없는 경우

RDS 인스턴스가 없다면:

#### 옵션 A: RDS 인스턴스 생성 (권장)

1. **RDS 콘솔에서 데이터베이스 생성**
   - "데이터베이스 생성" 버튼 클릭
   - 엔진 선택: PostgreSQL
   - 템플릿: 프리티어 (테스트) 또는 프로덕션 (운영)
   - 데이터베이스 이름: `labor_management`
   - 마스터 사용자 이름: `admin` (또는 원하는 이름)
   - 마스터 비밀번호: 강력한 비밀번호 설정

2. **네트워크 설정**
   - VPC: EC2와 같은 VPC 선택
   - 보안 그룹: 새로 생성하거나 기존 보안 그룹 사용
   - 퍼블릭 액세스: 필요시 "예" (또는 VPC 내부만)

3. **보안 그룹 설정**
   - RDS 보안 그룹 → 인바운드 규칙 편집
   - 규칙 추가:
     - 유형: PostgreSQL
     - 포트: 5432
     - 소스: EC2의 보안 그룹 ID 또는 EC2의 IP 주소 (43.200.44.109/32)

4. **데이터베이스 생성 완료 후**
   - 엔드포인트 확인
   - .env 파일 업데이트

#### 옵션 B: EC2에 PostgreSQL 설치

EC2 인스턴스에 PostgreSQL을 설치하는 방법 (로컬 개발용):

```bash
./install-postgresql.sh
```

⚠️ **주의**: EC2에 설치한 PostgreSQL은 EC2 내부에서만 접근 가능합니다.

## 확인 후 다음 단계

1. **RDS 인스턴스 정보 확인**
   - 엔드포인트
   - 포트
   - 사용자 이름
   - 비밀번호
   - 데이터베이스 이름

2. **.env 파일 업데이트 스크립트 실행**
   - RDS 정보를 받으면 `.env` 파일을 업데이트하는 스크립트를 제공하겠습니다.

3. **Prisma 마이그레이션 실행**
   - 데이터베이스 연결 후 마이그레이션 실행

4. **백엔드 재시작**
   - PM2로 백엔드 재시작
