# 카카오톡 로그인 기능 실제 적용 가이드

## ✅ 현재 상태

- ✅ 코드 구현 완료
- ✅ 환경 변수 파일 존재 (`apps/mobile/.env`)
- ✅ `VITE_KAKAO_JS_KEY` 설정됨
- ⏳ 카카오 개발자 콘솔 설정 필요

## 📋 실제 적용 단계

### 1단계: 카카오 개발자 콘솔 설정 (필수!)

#### 1-1. 카카오 개발자 콘솔 접속
1. 브라우저에서 **https://developers.kakao.com/** 접속
2. 카카오 계정으로 로그인

#### 1-2. 애플리케이션 선택 또는 생성
- **내 애플리케이션** 메뉴 클릭
- 기존 앱이 있으면 선택, 없으면 **애플리케이션 추가하기** 클릭
- 앱 이름 입력 (예: "장애인 근로관리")

#### 1-3. JavaScript 키 확인
1. **앱 설정** → **앱 키** 메뉴 클릭
2. **JavaScript 키** 복사
   - 현재 설정된 키: `4fd9be15675f83e1a441b25724837d57`
   - 다른 키를 사용한다면 `.env` 파일도 수정 필요

#### 1-4. Web 플랫폼 등록
1. **앱 설정** → **플랫폼** 메뉴 클릭
2. **Web 플랫폼 등록** 클릭
3. 사이트 도메인 입력:
   ```
   http://43.200.44.109:3001
   ```
4. **저장** 버튼 클릭

#### 1-5. 카카오 로그인 활성화
1. **제품 설정** → **카카오 로그인** 메뉴 클릭
2. **활성화 설정** 탭 클릭
3. **카카오 로그인** 토글을 **ON**으로 변경
4. **저장** 버튼 클릭

#### 1-6. Redirect URI 등록 (중요!)
1. **제품 설정** → **카카오 로그인** → **Redirect URI** 탭 클릭
2. **Redirect URI 등록** 버튼 클릭
3. 다음 URI를 **하나씩** 입력하고 **저장**:

   **프로덕션:**
   ```
   http://43.200.44.109:3001
   ```

   **개발 환경 (선택사항):**
   ```
   http://localhost:5174
   ```

⚠️ **주의사항:**
- 포트 번호(`:3001`)를 정확히 입력해야 합니다
- 마지막에 `/` 없이 입력해야 합니다
- `http://`와 `https://`는 별도로 등록해야 합니다

#### 1-7. 동의 항목 설정 (필수!)
1. **제품 설정** → **카카오 로그인** → **동의항목** 탭 클릭
2. **전화번호** 항목 찾기
3. **필수 동의**로 설정 ✅
   - 전화번호는 근로자 매칭에 필수입니다
4. **저장** 버튼 클릭

### 2단계: 환경 변수 확인 (이미 완료 ✅)

`apps/mobile/.env` 파일 확인:
```env
VITE_KAKAO_JS_KEY=4fd9be15675f83e1a441b25724837d57
```

**다른 JavaScript 키를 사용한다면:**
1. 카카오 개발자 콘솔에서 JavaScript 키 확인
2. `.env` 파일 수정

### 3단계: 모바일 앱 재빌드 및 배포

환경 변수를 적용하려면 앱을 재빌드해야 합니다:

```bash
# 프로젝트 루트에서 실행
bash redeploy-mobile.sh
```

**또는 수동 배포:**
```bash
# 1. 모바일 앱 빌드
cd apps/mobile
npm run build

# 2. 배포 스크립트 실행
cd ../..
bash redeploy-mobile.sh
```

### 4단계: 테스트

#### 4-1. 로그인 테스트
1. 브라우저에서 접속: **http://43.200.44.109:3001**
2. 브라우저 캐시 삭제 또는 시크릿 모드 사용
3. "카카오로 로그인" 버튼 클릭
4. 카카오 로그인 팝업 표시 확인
5. 카카오 계정으로 로그인
6. 로그인 성공 확인

#### 4-2. 자동 로그인 테스트 (카카오톡에서)
1. 카카오톡에서 계약서 링크 클릭
2. 이미 카카오톡에 로그인되어 있으면 자동 로그인 시도
3. 로그인 성공 후 계약서 서명 화면으로 이동 확인

## 🔍 문제 해결

### 문제 1: "카카오 SDK가 초기화되지 않았습니다"
**원인**: `VITE_KAKAO_JS_KEY`가 설정되지 않았거나 잘못된 키

**해결**:
1. `apps/mobile/.env` 파일 확인
2. JavaScript 키가 올바른지 확인
3. 모바일 앱 재빌드 및 재배포

### 문제 2: "redirect_uri_mismatch" 오류
**원인**: Redirect URI가 등록되지 않았거나 잘못된 URI

**해결**:
1. 카카오 개발자 콘솔에서 Redirect URI 확인
2. 정확한 도메인과 포트 등록 (`http://43.200.44.109:3001`)
3. 마지막에 `/` 없이 입력

### 문제 3: "등록된 정보가 없습니다" 오류
**원인**: 카카오 계정의 전화번호로 등록된 근로자가 없음

**해결**:
1. 먼저 회사 초대 링크를 통해 근로자 등록
2. 근로자의 전화번호가 카카오 계정과 일치하는지 확인
3. 카카오 개발자 콘솔에서 전화번호 동의 항목이 필수로 설정되어 있는지 확인

### 문제 4: 카카오 로그인 팝업이 안 뜸
**원인**: JavaScript 키가 설정되지 않았거나 SDK 초기화 실패

**해결**:
1. `apps/mobile/.env` 파일 확인
2. 브라우저 콘솔에서 오류 메시지 확인
3. 모바일 앱 재시작 또는 재빌드

## 📝 체크리스트

실제 적용 전 확인사항:

- [ ] 카카오 개발자 콘솔 접속 완료
- [ ] 애플리케이션 생성 또는 선택 완료
- [ ] JavaScript 키 확인 완료
- [ ] Web 플랫폼 등록 완료 (`http://43.200.44.109:3001`)
- [ ] 카카오 로그인 활성화 완료
- [ ] Redirect URI 등록 완료 (`http://43.200.44.109:3001`)
- [ ] 전화번호 동의 항목 필수로 설정 완료
- [ ] `apps/mobile/.env` 파일에 JavaScript 키 설정 완료 (이미 완료 ✅)
- [ ] 모바일 앱 재빌드 및 재배포 완료
- [ ] 테스트 완료

## 🚀 빠른 시작

모든 설정이 완료되었다면 다음 명령어로 한 번에 배포:

```bash
# 프로젝트 루트에서 실행
bash redeploy-mobile.sh
```

## 📞 추가 도움

문제가 발생하면:
1. 브라우저 콘솔에서 오류 메시지 확인 (F12 → Console)
2. 백엔드 로그 확인: `ssh ubuntu@43.200.44.109` 후 `pm2 logs backend`
3. 카카오 개발자 콘솔에서 설정 확인

---

**준비 완료!** 카카오 개발자 콘솔 설정만 완료하면 카카오 로그인 기능을 사용할 수 있습니다! 🎉
